<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Originator" content="ImportDoc" />
<meta name="OriginalFile" content="C:\HTML Help Projects\SDK-WindowsCE5\DOC\IDLScannerListener_Interface.doc" />
<meta name="topic-status" content="In Progress" />
<meta name="topic-priority" content="0" />
<meta name="topic-time-estimate" content="0" />
<meta name="topic-comment" content="" />
<meta name="topic-id" content="Html\IDLScannerListener_Interface.htm" />
<meta name="generator" content="Adobe RoboHelp 2015" />
<title>IDLScannerListener Interface</title>

<style type="text/css">
/*<![CDATA[*/
A:visited {
        color: #0000ff;
}
A:link {
        color: #0000ff;
}
/*]]>*/
</style>
</head>
<body lang="IT" xml:lang="IT">
<h2><b style="font-weight: bold;"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 14.0pt;">IDLScannerListener</span></font></b></h2>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">To make your application listen the scanner events, it is necessary to define a class inheriting the IDLScannerListener interface.</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">Furthermore, the defined class must implement the following method:</span></font></p>
<p class="Normal">&#160;</p>
<table style="margin-left: 3.5pt; border-collapse: collapse;" cellspacing="0" width="100%" bgcolor="#CCCCCC">
<tr>
<td style="vertical-align: top; padding: 0cm 3.5pt 0cm 3.5pt; padding-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;" width="642">
<p class="Normal" style="font-family: Verdana; font-size: 8.0pt; font-weight: bold;"><b><span lang="EN-US" xml:lang="EN-US" style="font-weight: bold;"><a name="notify" id="notify"></a>void notify(enum DLScannerEvents eEvent, const class DLScanner&amp; oScanner)</span></b></p>
</td>
</tr>
</table>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">When an event occurs, the class implementation manages the action to perform.</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal" style="font-family: Verdana; font-size: 8.0pt;"><span lang="EN-US" xml:lang="EN-US">When the application is notified the acquisition of a barcode label event, if the <a href="ScannerSetup_Class_ScanPars_Continuous.htm">Continuous Mode</a> parameter is disabled, the scanner is deactivated until the application doesn't return the scanner driver control. The control is returned by the application when the notify method ends. The quicker the new barcode label is managed by the application in the notify method, the sooner a new barcode acquisition can be performed.</span></p>
<p class="Normal">&#160;</p>
<h3><b style="font-weight: bold;"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 10.0pt;">Parameters</span></font></b></h3>
<p class="Normal"><i><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt; font-style: italic;">eEvent</span></font></i></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">one of the following values:</span></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">DLLabelEvent = a new barcode label;</span></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">DLStartScanningEvent = scanning started;</span></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">DLStopScanningEvent = scanning stopped;</span></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">DLTimeOutEvent = scanning timed out.</span></p>
<p class="Normal"><i><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt; font-style: italic;">oScanner</span></font></i></p>
<p class="Normal" style="margin-left: 40px;"><span lang="EN-US" xml:lang="EN-US">the current instance of DLScanner class.</span></p>
<p class="Normal">&#160;</p>
<p class="Normal">&#160;</p>
<h3><b style="font-weight: bold;"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 10.0pt;">Return Value</span></font></b></h3>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">None</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal">&#160;</p>
<h3><b style="font-weight: bold;"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 10.0pt;">Requirements</span></font></b></h3>
<table style="border-collapse: collapse;" cellspacing="0">
<col style="width: 15%;" />
<col width="587" />
<tr>
<td style="width: 15%; vertical-align: top; padding: 0cm 3.5pt 0cm 3.5pt; padding-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;">
<p class="Normal"><b><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt; font-weight: bold;">Header:</span></font></b></p>
</td>
<td style="vertical-align: top; padding: 0cm 3.5pt 0cm 3.5pt; padding-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;" width="587">
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">declared in <i><span style="font-style: italic;">DLScanner.h</span></i>, include <i><span style="font-style: italic;">DL_SEDAPI.h</span></i></span></font></p>
</td>
</tr>
<tr>
<td style="width: 15%; vertical-align: top; padding: 0cm 3.5pt 0cm 3.5pt; padding-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;">
<p class="Normal"><b><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt; font-weight: bold;">Library:</span></font></b></p>
</td>
<td style="vertical-align: top; padding: 0cm 3.5pt 0cm 3.5pt; padding-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px;" width="587">
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">use <i><span style="font-style: italic;">SEDAPI.lib</span></i></span></font></p>
</td>
</tr>
</table>
<p class="Normal">&#160;</p>
<p class="Normal">&#160;</p>
<h3><b style="font-weight: bold;"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 10.0pt;">Example</span></font></b><a name="Example" id="Example"></a></h3>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">#include "dl_sedapi.h"</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">class myClass : public IDLScannerListener</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">public:</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;myClass() {;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;virtual ~myClass() {;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;void notify(enum DLScannerEvents eEvent, const class DLScanner&amp; oScanner)</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;switch (eEvent)</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case IDLScannerListener::DLLabelEvent:</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;DLScanner&amp; oMyScanner = (DLScanner&amp;) oScanner;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//GET LABEL MESSAGE</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;size_t nTextLength = oMyScanner.getLabelTextLength();</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (nTextLength&gt;0)</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TCHAR* sText = new TCHAR[nTextLength+1];</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (sText != NULL)</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;oMyScanner.getLabelText(sText, nTextLength);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sText[nTextLength] = _T('\0');</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//SHOW LABEL MESSAGE</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MessageBox(NULL,sText, _T("New Barcode!"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;delete [] sText;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//ERROR MESSAGE</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MessageBox(NULL,_T("Error on malloc!"),_T("Error"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case IDLScannerListener::DLStartScanningEvent:</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//MessageBox(NULL, _T("scanning!"),_T("Scanner Status"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case IDLScannerListener::DLStopScanningEvent:</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//MessageBox(NULL, _T("waiting barcode..."),_T("Scanner Status"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;case IDLScannerListener::DLTimeOutEvent:</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//MessageBox(NULL, _T("read time out!"), _T("Scanner Status"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;} // end of switch</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;}&#160;&#160;// end of notify method</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">};</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><b><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 9.0pt; font-weight: bold;">int WINAPI WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance, LPWSTR lpCmdLine, int nShowCmd)</span></font></b></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;myClass myObject;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;DLScanner oScanner;</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;bool bInit = oScanner.init();</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;if (bInit == true)</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MessageBox(NULL,_T("START!"),_T("SCANNER"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></font><font><span lang="EN-US" xml:lang="EN-US" style="font-size: 7.5pt;">oScanner.scanEnable();</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;oScanner.attachListener(myObject);</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// ....</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// main program loop</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// ....</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;oScanner.detachListener(myObject);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;oScanner.scanDisable();</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;oScanner.deinit();</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MessageBox(NULL,_T("END!"),_T("SCANNER"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;else</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;{</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;MessageBox(NULL,_T("Error on init!"),_T("SCANNER Error"), MB_OK|MB_TOPMOST|MB_SETFOREGROUND);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;</span></font><font><span style="font-size: 7.5pt;">}</span></font></p>
<p class="Normal">&#160;</p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span style="font-size: 8.0pt;">&#160;&#160;&#160;&#160;return (0);</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span style="font-size: 8.0pt;">}</span></font></p>
<p class="Normal"><font style="font-family: Verdana;" face="Verdana"><span lang="EN-US" xml:lang="EN-US" style="font-size: 8.0pt;">&#160;</span></font><span lang="EN-US" xml:lang="EN-US">&#160;</span></p>
</body>
</html>
